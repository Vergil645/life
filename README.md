# life

## Description

Simple `C` implementation of Conway's Game of Life based on `SDL2` library.

## Build

```sh
cmake -S . -B build
cmake --build build
```

## Run

```sh
./build/bin/start
```

## LLVM IR

Repository contains LLVM IR of `src/app.c` file in [IR](./IR) directory.
It was generated by [genIR](./genIR) scipt.

## LLVM pass

Source code of the pass and the logger is located in [pass](./pass/) directory.

Script [compileWithPass.sh](./compileWithPass.sh) compiles pass (`libPass.so`) and compiles whole application using this pass.
This script also produces `app_with_trace.ll` IR file located in [IR](./IR) directory.

Pass affects only `void app()` function from `src/app.c` file - it logs running instruction and who uses it.

Pass doesn't log the following instructions:
- `ret`
- `phi`

Analysis script and statistics file are located in [statistics](./statistics/) directory.
Brief summary:

```
"Instruction <- User"           Percentage
------------------------------  ------------
getelementptr <- load           16.8%
getelementptr <- getelementptr  14.9%
load <- add                     14.9%
add <- add                      11.2%
add <- icmp                     5.7%
add <- call                     5.6%
icmp <- and                     3.7%
icmp <- br                      2.0%
getelementptr <- store          2.0%
zext <- store                   2.0%
trunc <- udiv                   1.9%
trunc <- urem                   1.9%
urem <- switch                  1.9%
urem <- add                     1.9%
udiv <- add                     1.9%
mul <- add                      1.9%
load <- icmp                    1.9%
load <- mul                     1.9%
icmp <- or                      1.9%
and <- or                       1.9%
or <- zext                      1.9%
...
```

## IRGen

Original source file `app.c` has been modified in order to simplify its IR.
All IR files has been generated again as well as statistics about instruction uses (LLVM pass).

Source code of IR generator is placed in [IRGen](./IRGen/) directory.
Also within [IR](./IR/) directory file `app_gen.ll` has been placed, which contains generated IR.

## ASM to IR

Directory [ISA](./ISA/) contains implementation of *ASM to IR* application.
ISA description can be found in file `./ISA/include/ISA.h`.

Source code of `app` module written in ASM can be found in file `app.s` within [ISA](./ISA/) directory.

Special instructions `LOAD_b`, `STORE_b`, `ADD_ASSIGN_LOAD_bi` and `INC_NE_i` encapsulates some frequently used (according to statistics) instruction combinations:

```
"Instruction <- User"           Percentage
------------------------------  ------------
getelementptr <- load           16.8%
getelementptr <- getelementptr  14.9%
load <- add                     14.9%
...
add <- icmp                     5.7%
...
getelementptr <- store          2.0%
...
```

## FrontEnd

Directory [FrontEnd](./FrontEnd/) contains implementation for FrontEnd of my language.

Source code of `app` module written in my language can be found in file `app.lang` within [FrontEnd](./FrontEnd/) directory.

Directory [FrontEnd/examples](./FrontEnd/examples/) contains example programs written in for subsets of my language.

Script [build.sh](./FrontEnd/build.sh) can be used to build FrontEnd application.
Compiled `start.out` binary can be run in 2 modes:
1. `start.out run` translates language into IR and execute it;
2. `start.out` only translates language into IR.

Language description:
1. Program consists of 1+ function declarations.
   - Function must be defined before usage.
   - Executable program must contain `main` function.
   - Currently functions can only have type `() -> void`.
2. Function consists of statements:
   - `Declaration`
   - `Assignment`
   - `Put`
   - `Flush`
   - `FunctionCall`
   - `IfStatement`
   - `LoopStatement`
   - `ContinueStatement`
   - `BreakStatement`
3. Variable can be one of:
   - 32-bit integer variable,
   - fixed size array (allocated on stack, has constant size) of 32-bit integer values.
4. Variable must be **declared** via `let` keyword before any usage:
   - `let x = 1;` (instead of `1` there can be any expression)
   - or `let x[128];`
5. Conditional branching have syntax `if ... { ... }`.
6. `loop { ... }` is an infinite loop.
7. `break if ...;` breaks innermost loop if condition is not 0.
8. `continue if ...;` continues innermost loop if condition is not 0.